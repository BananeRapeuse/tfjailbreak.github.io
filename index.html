<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jailbreak App</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        .hidden {
            display: none;
        }
        #blackScreen, #secondBlackScreen, #thirdBlackScreen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: black;
            color: white;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            font-size: 20px;
        }
        #blackScreenLogo {
            transition: opacity 0.5s;
            width: 120px;
            height: 120px;
        }
    </style>
</head>
<body>
    <img src="https://raw.githubusercontent.com/BananeRapeuse/tfjailbreak.github.io/main/IMG_2369.jpeg" alt="App Logo" width="200">
    <div id="progressContainer" class="hidden">
        <p id="statusMessage">Jailbreak for iOS/iPadOS 7.0-18.x beta</p>
        <div style="width: calc(100% - 50px); height: 30px; border: 1px solid #000;">
            <div id="progressBar" style="height: 100%; width: 0; background-color: green;"></div>
        </div>
    </div>
    <button id="jailbreakButton">Jailbreak</button>
    <div id="installCydiaMessage" class="hidden">
        <button id="installCydiaButton">Install Cydia 2</button>
    </div>
    <div id="completionMessage" class="hidden"></div>
    <div id="blackScreen">
        <img id="blackScreenLogo" src="https://raw.githubusercontent.com/BananeRapeuse/tfjailbreak.github.io/main/IMG_2379.jpeg" alt="Black Screen Logo">
        <div id="codeLines"></div>
    </div>
    <div id="secondBlackScreen">
        <img src="https://raw.githubusercontent.com/BananeRapeuse/tfjailbreak.github.io/main/IMG_2383.jpeg" alt="Second Black Screen Logo">
    </div>
    <div id="thirdBlackScreen">
        <img src="https://raw.githubusercontent.com/BananeRapeuse/tfjailbreak.github.io/main/IMG_2379.jpeg" alt="Third Black Screen Logo">
    </div>
    <button id="resetButton" class="hidden">Reset Jailbreak</button>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            function setCookie(name, value, days) {
                let expires = "";
                if (days) {
                    const date = new Date();
                    date.setTime(date.getTime() + (days*24*60*60*1000));
                    expires = "; expires=" + date.toUTCString();
                }
                document.cookie = name + "=" + (value || "")  + expires + "; path=/";
            }

            function getCookie(name) {
                let nameEQ = name + "=";
                let ca = document.cookie.split(';');
                for(let i=0;i < ca.length;i++) {
                    let c = ca[i];
                    while (c.charAt(0)==' ') c = c.substring(1,c.length);
                    if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
                }
                return null;
            }

            function eraseCookie(name) {
                document.cookie = name + '=; Max-Age=-99999999;';
            }

            const jailbreakButton = document.getElementById('jailbreakButton');
            const progressBar = document.getElementById('progressBar');
            const installCydiaButton = document.getElementById('installCydiaButton');
            const installCydiaMessage = document.getElementById('installCydiaMessage');
            const statusMessage = document.getElementById('statusMessage');
            const resetButton = document.getElementById('resetButton');

            if (getCookie('Jailbroken') === '1') {
                document.getElementById('progressContainer').classList.remove('hidden');
                progressBar.style.width = '100%';
                statusMessage.textContent = 'Jailbroken';
                installCydiaMessage.classList.add('hidden');
                document.getElementById('completionMessage').innerHTML = `
                    <button id="finalInstallCydiaButton">Install Cydia 2</button>
                    <div>You can close the application</div>
                `;
                document.getElementById('completionMessage').classList.remove('hidden');

                document.getElementById('finalInstallCydiaButton').addEventListener('click', function() {
                    window.location.href = 'https://github.com/BananeRapeuse/tfjailbreak.github.io/releases/download/Cydia2/cydia2npay.mobileconfig';
                });
            } else {
                jailbreakButton.addEventListener('click', function() {
                    jailbreakButton.style.display = 'none';
                    document.getElementById('progressContainer').classList.remove('hidden');

                    setTimeout(() => {
                        progressBar.style.width = '3%';
                        statusMessage.textContent = 'Verifying jailbreak possibility';

                        setTimeout(() => {
                            progressBar.style.width = '30%';
                            statusMessage.textContent = 'Downloading kernel';

                            setTimeout(() => {
                                progressBar.style.width = '60%';
                                statusMessage.textContent = 'Downloading bootstrap';

                                setTimeout(() => {
                                    progressBar.style.width = '75%';
                                    statusMessage.textContent = 'Finishing exploit';

                                    setTimeout(() => {
                                        progressBar.style.width = '100%';
                                        statusMessage.textContent = 'Jailbroken';
                                        installCydiaMessage.classList.remove('hidden');
                                    }, 3000);
                                }, 10000);
                            }, 5000);
                        }, 1000);
                    }, 2000);
                });
            }

            installCydiaButton.addEventListener('click', function() {
                this.style.display = 'none';
                const installCydiaMessage = document.getElementById('installCydiaMessage');
                const statusMessage = document.getElementById('statusMessage');
                const blackScreen = document.getElementById('blackScreen');
                const codeLines = document.getElementById('codeLines');
                const blackScreenLogo = document.getElementById('blackScreenLogo');

                let countdown = 10;
                const countdownInterval = setInterval(() => {
                    statusMessage.textContent = `Your device will reboot in ${countdown} seconds to completely finish the jailbreak`;
                    countdown -= 1;
                    if (countdown < 0) {
                        clearInterval(countdownInterval);
                        statusMessage.style.display = 'none';
                        blackScreen.style.display = 'flex';

                        setTimeout(() => {
                            blackScreenLogo.style.opacity = 1; // Show logo
                            setTimeout(() => {
                                blackScreenLogo.src = "https://raw.githubusercontent.com/BananeRapeuse/tfjailbreak.github.io/main/IMG_2380.jpeg";
                                let messages = [
                                    'Unpacking kernel',
                                    'Patching kernel',
                                    'Unpacking bootstrap',
                                    'Unable root access',
                                    'Root xnu',
                                    'Rebooting on DFUâ€¦'
                                ];
                                let delay = [10000, 1000, 20000, 3000, 5000, 0];
                                let messageIndex = 0;

                                function showNextMessage() {
                                    if (messageIndex < messages.length) {
                                        codeLines.textContent = messages[messageIndex];
                                        messageIndex++;
                                        setTimeout(showNextMessage, delay[messageIndex - 1]);
                                    } else {
                                        setTimeout(() => {
                                            blackScreen.style.display = 'none';
                                            const secondBlackScreen = document.getElementById('secondBlackScreen');
                                            secondBlackScreen.style.display = 'flex';

                                            setTimeout(() => {
                                                secondBlackScreen.style.display = 'none';
                                                const thirdBlackScreen = document.getElementById('thirdBlackScreen');
                                                thirdBlackScreen.style.display = 'flex';

                                                setTimeout(() => {
                                                    thirdBlackScreen.style.display = 'none';
                                                    progressBar.style.width = '100%';
                                                    statusMessage.textContent = 'Jailbroken';
                                                    installCydiaMessage.classList.add('hidden');
                                                    document.getElementById('completionMessage').innerHTML = `
                                                                                                                <button id="finalInstallCydiaButton">Install Cydia 2</button>
                                                        <div>You can close the application</div>
                                                    `;
                                                    document.getElementById('completionMessage').classList.remove('hidden');
                                                    setCookie('Jailbroken', '1', 365*10); // Set cookie for 10 years

                                                    document.getElementById('finalInstallCydiaButton').addEventListener('click', function() {
                                                        window.location.href = 'https://github.com/BananeRapeuse/tfjailbreak.github.io/releases/download/Cydia2/cydia2v2free.mobileconfig';
                                                    });
                                                }, 10000); // Show final black screen for 10 seconds
                                            }, 7000); // Show second black screen for 7 seconds
                                        }, delay[delay.length - 1]);
                                    }
                                }

                                setTimeout(showNextMessage, 7000); // Wait 7 seconds before starting to show messages
                            }, 20000); // Wait 20 seconds before showing the messages
                        }, 7000); // Wait 7 seconds before showing the first logo
                    }
                }, 1000); // Countdown interval of 1 second
            });

            resetButton.addEventListener('click', function() {
                eraseCookie('Jailbroken');
                location.reload();
            });

            resetButton.classList.remove('hidden'); // Show reset button for testing
        });
    </script>
</body>
</html>
